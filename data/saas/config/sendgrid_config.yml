saas_config:
  fides_key: sendgrid_connector_example
  name: Sendgrid SaaS Config
  description: A sample schema representing the Sendgrid connector for Fidesops
  version: 0.0.1

  connector_params:
    - name: host
    - name: api_key

  client_config:
    protocol: https
    host:
      connector_param: host
    authentication:
      strategy: bearer_authentication
      configuration:
        token:
          connector_param: api_key

  test_request:
    method: GET
    path: /v3/marketing/contacts
    
  endpoints:
  - name: contacts
    requests:
      read:
        method: POST
        path: /v3/marketing/contacts/search
        body: "{\"query\": \"email = '<email>'\"}" # do just emails for now. we don't have support for more dynamic query building.
        param_values:
          - name: email
            identity: email
        data_path: result
      delete:
        method: DELETE
        path: /v3/marketing/contacts
        query_params:
          - name: ids
            value: <contact_id>
        param_values:
          - name: contact_id
            references:
              - dataset: sendgrid_connector_example
                field: contacts.id
                direction: from
  - name: lists
    after: ['sendgrid_connector_example.contacts']
    requests:
      read:
        method: GET
        path: /v3/marketing/lists/<list_id>
        param_values:
          - name: list_id
            references:
              - dataset: sendgrid_connector_example
                field: contacts.list_ids
                direction: from
      delete:
        method: DELETE
        path: /v3/marketing/lists/<list_id>/contacts
        query_params:
          - name: contact_ids
            value: <contact_id>
        param_values:
          - name: list_id
            references:
              - dataset: sendgrid_connector_example
                field: lists.id
                direction: from
          - name: contact_id
            references:
              - dataset: sendgrid_connector_example
                field: contacts.id
                direction: from
 