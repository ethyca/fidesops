saas_config:
  fides_key: customer_connector_example
  name: Customer SaaS Config
  description: A sample schema representing the Customer connector for Fidesops
  version: 0.0.1

  connector_params:
    - name: app_api_key
    - name: tracking_site_id
    - name: tracking_api_key

  client_config:
    protocol: https
    host:
      connector_param: domain
    authentication:
      strategy: bearer_authentication
      configuration:
        token:
          connector_param: app_api_key

  test_request:
    path: /v1/api/segments
    method: GET

  endpoints:
  - name: customer_search
    requests:
      read:
        path: /v1/api/customers
        method: GET
        query_params:
          - name: email
            value: <email>
        param_values:
          - name: email
            identity: email
            data_type: string
        data_path: results
  - name: customers
    requests:
      read:
        path: /v1/api/customers/<customer_id>/attributes
        method: GET
        param_values:
          - name: customer_id
            references:
              - dataset: customer_connector_example
                field: customer_search.results.id # TODO - Can we confirm the results data_path is appropriate
                direction: from
        data_path: customer
      delete:
        # TODO - Has to figure out a way to send different host values
        path: /api/v1/customers/<customer_id>
        method: GET
        param_values:
          - name: customer_id
            references:
              - dataset: customer_connector_example
                field: customers.customer.id
                direction: from
  - name: segments
    requests:
      read:
        path: /v1/api/customers/<customer_id>/segments
        method: GET
        param_values:
          - name: customer_id
            references:
              - dataset: customer_connector_example
                field: customer_search.results.id
                direction: from
        data_path: segments
      delete:
        path: /api/v1/segments/<segment_id>/remove_customers
        method: POST
        # TODO - custom authorization hasn't implemented at the time writing this
        # TODO - Custom HTTP method and body for POST hasn't implemented at the time writing this
        param_values:
          - name: segment_id
            references:
              - dataset: customer_connector_example
                field: segments.segments.id
                direction: from
  - name: activities
    requests:
      read:
        path: /v1/api/customers/<customer_id>/activities
        method: GET
        param_values:
          - name: customer_id
            references:
              - dataset: customer_connector_example
                field: customer_search.results.id
                direction: from
        data_path: activities
  - name: messages
    requests:
      read:
        path: /v1/api/customers/<customer_id>/messages
        method: GET
        param_values:
          - name: customer_id
            references:
              - dataset: customer_connector_example
                field: customer_search.results.id
                direction: from
        data_path: messages                